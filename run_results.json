{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-11T00:53:10.848475Z", "invocation_id": "887f73af-1c35-48e4-b4eb-6e067e1404c4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:25.322276Z", "completed_at": "2025-03-11T00:52:25.334272Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:25.335270Z", "completed_at": "2025-03-11T00:52:28.503939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1836659908294678, "adapter_response": {"_message": "CREATE TABLE (2.2k rows, 7.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 2191, "bytes_processed": 7512, "bytes_billed": 10485760, "location": "US", "project_id": "soft-drink-grocery", "job_id": "4b7a7c58-d340-4797-a6c3-d61613d2a601", "slot_ms": 11329}, "message": "CREATE TABLE (2.2k rows, 7.3 KiB processed)", "failures": null, "unique_id": "model.softdrink_grocery.calendar", "compiled": true, "compiled_code": "with date_spine as (\r\n    select\r\n        date_add(date '2020-01-01', interval day*1 day) as date\r\n    from\r\n        unnest(generate_array(0, 365*6)) as day\r\n),\r\n\r\ncalendar as (\r\n    select\r\n        date,\r\n        extract(year from date) as year,\r\n        extract(month from date) as month,\r\n        extract(day from date) as day,\r\n        extract(dayofweek from date) as weekday,\r\n        extract(quarter from date) as quarter,\r\n        case when extract(dayofweek from date) in (1, 7) then true else false end as is_weekend,\r\n        format_date('%b', date) as month_name,  -- Jan, Feb, etc.\r\n        format_date('%b/%y', date) as month_year,  -- Jan/22, Feb/22, etc.\r\n\r\n        -- Find the Thursday of the current week\r\n        date_sub(date, interval mod(extract(dayofweek from date) - 5, 7) day) as week_start,\r\n\r\n        -- Add 6 days to get the Wednesday (week-end date)\r\n        date_add(date_sub(date, interval mod(extract(dayofweek from date) - 5, 7) day), interval 6 day) as week_end_date\r\n    from date_spine\r\n)\r\n\r\nselect\r\n    c.*,\r\n    r.`Week` as w_no,\r\n    r.`Week_Index` as week_index  -- Bringing the 'Week' column from raw_wno\r\nfrom calendar c\r\nleft join `soft-drink-grocery.raw.raw_wno` r\r\n    on c.`week_end_date` = date(r.`End Week`)", "relation_name": "`soft-drink-grocery`.`marts`.`calendar`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:28.513034Z", "completed_at": "2025-03-11T00:52:28.517942Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:28.519042Z", "completed_at": "2025-03-11T00:52:29.614008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.104069471359253, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "a1170758-d6e3-4600-8d7d-247f1fe9d052", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_ccl_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_ccl_sales`\n\n),\n\nrenamend as (\n    select\n        Geography as store_id,\n        Product as product,\n        `UPC ID` as upc_no,\n        CAST(`UPC ID` as int) as upc_int,\n        CAST(`Dollar Sales` AS float64) as dollar_sales,\n        CAST(`Unit Sales` AS int64) as unit_sales,\n        CAST(`Time` AS DATE) as week_end_date,\n        retail_group,\n        CONCAT(retail_group, '|', Geography) as unique_store_id,\n        CONCAT(retail_group, '|', Geography, '|', `UPC ID`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_ccl_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:29.621025Z", "completed_at": "2025-03-11T00:52:29.628008Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:29.629008Z", "completed_at": "2025-03-11T00:52:30.654964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0349552631378174, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "05b93548-9081-416a-adc7-9eabdc56aedc", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_ccl_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_ccl_stores`\n\n),\n\nrenamend as (\n    select\n        Geography as store_name,\n        `Store Number` as store_id,\n        `Division Name` as banner,\n        'AB' as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Store Number`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_ccl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:30.661964Z", "completed_at": "2025-03-11T00:52:30.682070Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:30.683070Z", "completed_at": "2025-03-11T00:52:31.623877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9628996849060059, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "1706e56d-9fb2-473a-b4f7-acf95d310009", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_fcl_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_fcl_sales`\n\n),\n\nrenamend as (\n    select\n        `Store Number` as store_id,\n        `Product Name` as product,\n        UPC as upc_no,\n        CAST(`UPC` as int) as upc_int,\n        CAST(`Dollar Sales` AS float64) as dollar_sales,\n        CAST(`Unit Sales` AS int64) as unit_sales,\n        CAST(`Week End Date` AS DATE) as week_end_date,\n        retail_group,\n        `Promotion Type Name` as promo_type,\n        CONCAT(retail_group, '|', `Store Number`) as unique_store_id,\n        CONCAT(retail_group, '|', `Store Number`, '|', `UPC`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_fcl_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:31.629885Z", "completed_at": "2025-03-11T00:52:31.635888Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:31.636876Z", "completed_at": "2025-03-11T00:52:32.617286Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9894006252288818, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "138e586e-57b1-4ae7-91f8-4d7ad12dda63", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_fcl_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_fcl_sales`\n\n),\n\nrenamend as (\n    select\n        `Store Name` as store_name,\n        `Store Number` as store_id,\n        'Federated Coop' as banner,\n        Province as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Store Number`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_fcl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:32.623286Z", "completed_at": "2025-03-11T00:52:32.631284Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:32.631284Z", "completed_at": "2025-03-11T00:52:33.862713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2404282093048096, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "6d72d8f1-3670-4029-851d-32a6cd60407b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_lcl_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_lcl_sales`\n\n),\n\nrenamend as (\n    select\n        `Site Number` as store_id,\n        UPC_Description as product,\n        `UPC` as upc_no,\n        CAST(`UPC` as int) as upc_int,\n        CAST(REPLACE(REPLACE(`Sales`, '$', ''), ',', '') AS float64) as dollar_sales,\n        CAST(`Units` AS int64) as unit_sales,\n        CAST(REPLACE(REPLACE(`Promo Sales`, '$', ''), ',', '') AS float64) as promo_dollar_sales,\n        CAST(`Promo Units` AS int64) as promo_unit_sales,\n        CAST(`Week End Date` AS DATE) as week_end_date,\n        retail_group,\n        CONCAT(retail_group, '|', `Site Number`) as unique_store_id,\n        CONCAT(retail_group, '|', `Site Number`, '|', `UPC`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_lcl_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:33.869712Z", "completed_at": "2025-03-11T00:52:33.874715Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:33.875707Z", "completed_at": "2025-03-11T00:52:34.908674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0419666767120361, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "a4674912-7fb0-4017-ba2d-3c743c8e8c65", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_lcl_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_lcl_stores`\n\n),\n\nrenamed as (\n    select\n        `Store Name` as store_name,\n        `Store No` as store_id,\n        Division as division,\n        case\n            when lower(`Store Banner`) = 'nofrills' then 'NoFrills'\n            when lower(`Store Banner`) = 'nofrills' then 'NoFrills'\n            when lower(`Store Banner`) = 'no name store' then 'no name'\n            else `Store Banner`\n        end as banner,\n        Prv as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Store No`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamed", "relation_name": "`soft-drink-grocery`.`staging`.`stg_lcl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:34.916674Z", "completed_at": "2025-03-11T00:52:34.922681Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:34.923675Z", "completed_at": "2025-03-11T00:52:35.865043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9503688812255859, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "9375271f-6e0d-4911-8f4d-32097596929d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_metro_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_metro_sales`\n\n),\n\nrenamend as (\n    select\n        `Store No` as store_id,\n        Product as product,\n        `UPC ID` as upc_no,\n        CAST(`UPC ID` as int) as upc_int,\n        CAST(`Dollar Sales` AS float64) as dollar_sales,\n        CAST(`Unit Sales` AS int64) as unit_sales,\n        PARSE_DATE('%m/%d/%Y', `Week End Date`) as week_end_date,\n        retail_group,\n        CONCAT(retail_group, '|', `Store No`) as unique_store_id,\n        CONCAT(retail_group, '|', `Store No`, '|', `UPC ID`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_metro_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:35.871044Z", "completed_at": "2025-03-11T00:52:35.877042Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:35.877042Z", "completed_at": "2025-03-11T00:52:36.889942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0208966732025146, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "19a0aa61-60cc-40d6-a8ae-1373ea14eb11", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_metro_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_metro_stores`\n\n),\n\nrenamend as (\n    select\n        `Store Name` as store_name,\n        `Operational Site` as store_id,\n        case\n            when lower(`Banner Description`) = 'food basics' then 'Food Basics'\n            else `Banner Description`\n        end as banner,\n        Province as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Operational Site`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_metro_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:36.895935Z", "completed_at": "2025-03-11T00:52:36.901941Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:36.902933Z", "completed_at": "2025-03-11T00:52:37.875154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9812009334564209, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "86164ff6-ceaf-4c7d-bd09-a0d2ce13fdbb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_pfg_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_pfg_sales`\n\n),\n\nrenamend as (\n    select\n        Geography as store_id,\n        Product as product,\n        `UPC ID` as upc_no,\n        CAST(`UPC ID` as int) as upc_int,\n        CAST(`Dollar Sales` AS float64) as dollar_sales,\n        CAST(`Unit Sales` AS int64) as unit_sales,\n        CAST(`Time` AS DATE) as week_end_date,\n        retail_group,\n        CONCAT(retail_group, '|', Geography) as unique_store_id,\n        CONCAT(retail_group, '|', Geography, '|', `UPC ID`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_pfg_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:37.882147Z", "completed_at": "2025-03-11T00:52:37.889146Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:37.890146Z", "completed_at": "2025-03-11T00:52:38.819045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9378983974456787, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "d9d92d8a-55af-4e34-91a2-68c25dca8b39", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_pfg_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_pfg_stores`\n\n),\n\nrenamend as (\n    select\n        `Store Name` as store_name,\n        `Store Number` as store_id,\n        `Banner Name` as banner,\n        `Province Name`,\n        case\n            when `Province Name` = 'ALBERTA' then 'AB'\n            when `Province Name` = 'BRITISH COLUMBIA' then 'BC'\n            when `Province Name` = 'MANITOBA' then 'MB'\n            when `Province Name` = 'NEW BRUNSWICK' then 'NB'\n            when `Province Name` = 'NEWFOUNDLAND AND LABRADOR' then 'NL'\n            when `Province Name` = 'NORTHWEST TERRITORIES' then 'NT'\n            when `Province Name` = 'NOVA SCOTIA' then 'NS'\n            when `Province Name` = 'NUNAVUT' then 'NU'\n            when `Province Name` = 'ONTARIO' then 'ON'\n            when `Province Name` = 'PRINCE EDWARD ISLAND' then 'PE'\n            when `Province Name` = 'QUEBEC' then 'QC'\n            when `Province Name` = 'SASKATCHEWAN' then 'SK'\n            when `Province Name` = 'YUKON' then 'YT'\n        END as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Store Number`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_pfg_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:38.825040Z", "completed_at": "2025-03-11T00:52:38.830039Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:38.831038Z", "completed_at": "2025-03-11T00:52:39.752514Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9284746646881104, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "4912f4e0-818a-4f74-8b31-c100ee5493cd", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_product", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_product_mf`\n\n),\n\nrenamend as (\n    select\n        product,\n        upc,\n        CAST(upc as int) as upc_int,\n        vendor,\n        brand,\n        category,\n        subcategory,\n        item_size,\n        item_unit,\n        pack_qty\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:39.758445Z", "completed_at": "2025-03-11T00:52:39.766436Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:39.766436Z", "completed_at": "2025-03-11T00:52:40.708006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9515058994293213, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "fcbd68ce-be59-433e-afcf-f6b5bb84782d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_sobeys_sales", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_sobeys_sales`\n\n),\n\nrenamend as (\n    select\n        store_id,\n        Product as product,\n        `UPC No` as upc_no,\n        CAST(`UPC No` as int) as upc_int,\n        CAST(`Dollar Sales All Sales` AS float64) as dollar_sales,\n        CAST(`Unit Sales All Sales` AS int64) as unit_sales,\n        CAST(`Time` AS DATE) as week_end_date,\n        retail_group,\n        CONCAT(retail_group, '|', store_id) as unique_store_id,\n        CONCAT(retail_group, '|', store_id, '|', `UPC No`) as pod\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_sobeys_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:40.714953Z", "completed_at": "2025-03-11T00:52:40.720957Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:40.720957Z", "completed_at": "2025-03-11T00:52:41.698389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9849765300750732, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "42511e0c-442a-444d-b716-17c206f9e2f2", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.stg_sobeys_stores", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from `soft-drink-grocery`.`raw`.`raw_sobeys_stores`\n\n),\n\nrenamend as (\n    select\n        Geography as store_name,\n        `Store No` as store_id,\n        `Division Name` as division,\n        `Format Name` as format,\n        `Banners Name` as banner,\n        `Province Name` as province,\n        retail_group,\n        CONCAT(retail_group, '|', `Store No`) as unique_store_id\n    from\n        source\n\n)\n\nselect * from renamend", "relation_name": "`soft-drink-grocery`.`staging`.`stg_sobeys_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:41.705447Z", "completed_at": "2025-03-11T00:52:41.712024Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:41.713016Z", "completed_at": "2025-03-11T00:52:42.771266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.066967248916626, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "019a7b36-9522-4b61-a2e8-9c23751f2427", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_ccl_stores", "compiled": true, "compiled_code": "with\n\nccl_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_ccl_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\nccl_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from ccl_stores\n)\n\nselect * from ccl_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_ccl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:42.778259Z", "completed_at": "2025-03-11T00:52:42.784269Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:42.784269Z", "completed_at": "2025-03-11T00:52:43.831415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0561442375183105, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "6b736c86-4026-4213-a69a-c8c40047b643", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_fcl_sales", "compiled": true, "compiled_code": "with\n\nfcl_sales as (\n\n    select * from `soft-drink-grocery`.`staging`.`stg_fcl_sales`\n\n),\n\nfcl_no_promo as (\n        select\n            store_id,\n            product,\n            upc_no,\n            upc_int,\n            dollar_sales,\n            unit_sales,\n            week_end_date,\n            retail_group,\n            unique_store_id,\n            pod\n    from fcl_sales\n)\n\nselect * from fcl_no_promo", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_fcl_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:43.839414Z", "completed_at": "2025-03-11T00:52:43.846424Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:43.847413Z", "completed_at": "2025-03-11T00:52:44.910193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0727856159210205, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "7d9916f8-dfc4-4f3c-bd5a-15d82c8f3ec0", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_fcl_stores", "compiled": true, "compiled_code": "with\n\nfcl_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_fcl_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\nfcl_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from fcl_stores\n)\n\nselect * from fcl_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_fcl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:44.916426Z", "completed_at": "2025-03-11T00:52:44.922342Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:44.922342Z", "completed_at": "2025-03-11T00:52:45.946868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0325403213500977, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "0c5feafa-0543-4201-a2b8-70d119a446a0", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_lcl_sales", "compiled": true, "compiled_code": "with\n\nlcl_sales as (\n\n    select * from `soft-drink-grocery`.`staging`.`stg_lcl_sales`\n\n),\n\nlcl_no_promo as (\n        select\n            store_id,\n            product,\n            upc_no,\n            upc_int,\n            dollar_sales,\n            unit_sales,\n            week_end_date,\n            retail_group,\n            unique_store_id,\n            pod\n    from lcl_sales\n)\n\nselect * from lcl_no_promo", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_lcl_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:45.952867Z", "completed_at": "2025-03-11T00:52:45.959867Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:45.959867Z", "completed_at": "2025-03-11T00:52:47.060730Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1088624000549316, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "3f3cedc8-77a2-4b94-9fe1-25d227501f54", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_lcl_stores", "compiled": true, "compiled_code": "with\n\nlcl_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_lcl_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\nlcl_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from lcl_stores\n)\n\nselect * from lcl_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_lcl_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:47.066735Z", "completed_at": "2025-03-11T00:52:47.074729Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:47.075729Z", "completed_at": "2025-03-11T00:52:48.140208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0754804611206055, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "912b5b68-3370-4279-87ac-dc4bb059cb9b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_metro_stores", "compiled": true, "compiled_code": "with\n\nmetro_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_metro_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\nmetro_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from metro_stores\n)\n\nselect * from metro_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_metro_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:48.148210Z", "completed_at": "2025-03-11T00:52:48.154209Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:48.154209Z", "completed_at": "2025-03-11T00:52:49.239165Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.093930721282959, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "8992cca8-2de2-4ac2-9a67-28643e5fe95a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_pfg_stores", "compiled": true, "compiled_code": "with\n\npfg_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_pfg_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\npfg_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from pfg_stores\n)\n\nselect * from pfg_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_pfg_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:49.246109Z", "completed_at": "2025-03-11T00:52:49.251348Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:49.251348Z", "completed_at": "2025-03-11T00:52:52.154651Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.9105567932128906, "adapter_response": {"_message": "CREATE TABLE (809.0 rows, 98.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 809, "bytes_processed": 100936, "bytes_billed": 10485760, "location": "US", "project_id": "soft-drink-grocery", "job_id": "5d701f73-0595-4a27-b05c-6882bc543487", "slot_ms": 3408}, "message": "CREATE TABLE (809.0 rows, 98.6 KiB processed)", "failures": null, "unique_id": "model.softdrink_grocery.product", "compiled": true, "compiled_code": "with product as (\n    select * from `soft-drink-grocery`.`staging`.`stg_product`\n)\n\nselect * from product", "relation_name": "`soft-drink-grocery`.`marts`.`product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:52.161659Z", "completed_at": "2025-03-11T00:52:52.168092Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:52.168092Z", "completed_at": "2025-03-11T00:52:53.179405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0187478065490723, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "soft-drink-grocery", "job_id": "beabd0ed-8355-4ee0-a8a7-2f19466bc40e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.softdrink_grocery.int_sobeys_stores", "compiled": true, "compiled_code": "with\n\nsobeys_stores as (\n    select * from `soft-drink-grocery`.`staging`.`stg_sobeys_stores`\n),\n\ndiscount_banners as (\n    select `Discount Banners` as discount_banner\n    from `soft-drink-grocery`.`raw`.`raw_discount_banners`\n),\n\nsobeys_stores_channel as (\n    select\n        store_name,\n        store_id,\n        banner,\n        province,\n        retail_group,\n        unique_store_id,\n        case\n            when banner in (select discount_banner from discount_banners) then 'Discount'\n            else 'Conventional'\n        end as channel\n    from sobeys_stores\n)\n\nselect * from sobeys_stores_channel", "relation_name": "`soft-drink-grocery`.`intermidiate`.`int_sobeys_stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:52:53.449246Z", "completed_at": "2025-03-11T00:52:53.456253Z"}, {"name": "execute", "started_at": "2025-03-11T00:52:53.456253Z", "completed_at": "2025-03-11T00:53:03.460550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.013309717178345, "adapter_response": {"_message": "CREATE TABLE (10.7m rows, 856.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 10682301, "bytes_processed": 898267460, "bytes_billed": 898629632, "location": "US", "project_id": "soft-drink-grocery", "job_id": "e7c713ec-b7c6-47f4-b023-31f9bc08571b", "slot_ms": 142243}, "message": "CREATE TABLE (10.7m rows, 856.7 MiB processed)", "failures": null, "unique_id": "model.softdrink_grocery.sales", "compiled": true, "compiled_code": "with lcl_sales as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_lcl_sales`\n),\n\nfcl_sales as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_fcl_sales`\n),\n\nsobeys_sales as (\n    select * from `soft-drink-grocery`.`staging`.`stg_sobeys_sales`\n),\n\nccl_sales as (\n    select * from `soft-drink-grocery`.`staging`.`stg_ccl_sales`\n),\n\npfg_sales as (\n    select * from `soft-drink-grocery`.`staging`.`stg_pfg_sales`\n),\n\nmetro_sales as (\n    select * from `soft-drink-grocery`.`staging`.`stg_metro_sales`\n),\n\nsales as (\n    select * from lcl_sales\n    union all\n    select * from fcl_sales\n    union all\n    select * from sobeys_sales\n    union all\n    select * from ccl_sales\n    union all\n    select * from pfg_sales\n    union all\n    select * from metro_sales\n)\n\nselect * from sales", "relation_name": "`soft-drink-grocery`.`marts`.`sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:53:03.466550Z", "completed_at": "2025-03-11T00:53:03.473557Z"}, {"name": "execute", "started_at": "2025-03-11T00:53:03.474557Z", "completed_at": "2025-03-11T00:53:07.776964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.312411308288574, "adapter_response": {"_message": "CREATE TABLE (156.2k rows, 6.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 156153, "bytes_processed": 6811608, "bytes_billed": 73400320, "location": "US", "project_id": "soft-drink-grocery", "job_id": "6758dd79-002d-4dc5-ac1e-c91b04436040", "slot_ms": 47727}, "message": "CREATE TABLE (156.2k rows, 6.5 MiB processed)", "failures": null, "unique_id": "model.softdrink_grocery.stores", "compiled": true, "compiled_code": "with lcl_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_lcl_stores`\n),\n\nfcl_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_fcl_stores`\n),\n\nsobeys_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_sobeys_stores`\n),\n\nccl_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_ccl_stores`\n),\n\npfg_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_pfg_stores`\n),\n\nmetro_stores as (\n    select * from `soft-drink-grocery`.`intermidiate`.`int_metro_stores`\n),\n\nstores as (\n    select * from lcl_stores\n    union all\n    select * from fcl_stores\n    union all\n    select * from sobeys_stores\n    union all\n    select * from ccl_stores\n    union all\n    select * from pfg_stores\n    union all\n    select * from metro_stores\n)\n\nselect * from stores", "relation_name": "`soft-drink-grocery`.`marts`.`stores`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-11T00:53:07.783964Z", "completed_at": "2025-03-11T00:53:07.788959Z"}, {"name": "execute", "started_at": "2025-03-11T00:53:07.789956Z", "completed_at": "2025-03-11T00:53:10.838478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.056523084640503, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 570.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 598456789, "bytes_billed": 598736896, "location": "US", "project_id": "soft-drink-grocery", "job_id": "0c0d3c92-70c2-4c59-ad8b-92426d3dfea9", "slot_ms": 8034}, "message": "CREATE TABLE (0.0 rows, 570.7 MiB processed)", "failures": null, "unique_id": "model.softdrink_grocery.product_missing", "compiled": true, "compiled_code": "with product as (\n    select * from `soft-drink-grocery`.`staging`.`stg_product`\n),\n\nsales as(\n    select * from `soft-drink-grocery`.`marts`.`sales`\n),\n\nproduct_missing as (\n    select\n    a.product,\n    a.upc_no,\n    a.retail_group,\n    b.brand\nfrom sales a\nleft join product b\n    on a.`upc_no` = b.`upc`\nwhere b.brand IS NULL\n)\n\nselect * from product_missing", "relation_name": "`soft-drink-grocery`.`marts`.`product_missing`", "batch_results": null}], "elapsed_time": 48.62769031524658, "args": {"defer": false, "exclude": [], "select": [], "log_level_file": "debug", "introspect": true, "cache_selected_only": false, "require_resource_names_without_spaces": false, "state_modified_compare_vars": false, "favor_state": false, "indirect_selection": "eager", "invocation_command": "dbt run", "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "require_yaml_configuration_for_mf_time_spines": false, "write_json": true, "log_format": "default", "source_freshness_run_project_hooks": false, "log_format_file": "debug", "project_dir": "C:\\Customer-Retail-Analytics", "version_check": true, "populate_cache": true, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "macro_debugging": false, "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "strict_mode": false, "print": true, "quiet": false, "require_nested_cumulative_type_params": false, "log_level": "info", "which": "run", "printer_width": 80, "static_parser": true, "vars": {}, "empty": false, "log_path": "C:\\Customer-Retail-Analytics\\logs", "profiles_dir": "C:\\Customer-Retail-Analytics", "state_modified_compare_more_unrendered_values": false}}